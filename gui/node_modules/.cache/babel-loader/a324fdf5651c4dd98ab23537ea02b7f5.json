{"ast":null,"code":"var _jsxFileName = \"/home/honza/webusb-test/src/webglAppSin.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useRef } from \"react\";\nimport { getOverlayDirection } from \"react-bootstrap/esm/helpers\";\nimport { WebglPlot, WebglLine, ColorRGBA } from \"webgl-plot\";\nimport './App.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nlet webglp;\nlet line;\nlet line2;\nlet line3;\nexport default function WebglAppSin(_ref) {\n  _s();\n\n  let {\n    data\n  } = _ref;\n  const canvasMain = useRef(null);\n  let TEST = Array(data.length).fill().map(() => 256 * Math.random());\n  useEffect(() => {\n    if (canvasMain.current) {\n      console.log(\"webgl\");\n      const devicePixelRatio = window.devicePixelRatio || 1;\n      canvasMain.current.width = canvasMain.current.clientWidth * devicePixelRatio;\n      canvasMain.current.height = canvasMain.current.clientHeight * devicePixelRatio;\n      webglp = new WebglPlot(canvasMain.current);\n      const numX = 1000;\n      line = new WebglLine(new ColorRGBA(0, 1, 0, 1), numX);\n      webglp.addLine(line);\n      line.arrangeX();\n      line2 = new WebglLine(new ColorRGBA(1, 1, 0, 1), numX);\n      webglp.addLine(line2);\n      line2.arrangeX();\n      line3 = new WebglLine(new ColorRGBA(0, 0, 1, 1), numX);\n      webglp.addLine(line3);\n      line3.arrangeX();\n    }\n  }, []);\n  useEffect(() => {\n    console.log('rendering frame');\n    let start = performance.now();\n    let flatData = data.length > 1 ? data.slice(data.length - 100, data.length).flat() : [1, 2, 3, 4]; // let flatData = Array(data.length).fill().map(() => 256 * Math.random());\n\n    let max = 256;\n\n    for (let i = 0; i < line.numPoints; i++) {\n      line.setY(i, 1.3 * flatData[Math.round(flatData.length * i / line.numPoints)] / max - 0.55);\n    } //  id = requestAnimationFrame(renderPlot);\n\n\n    webglp.update();\n    console.log((performance.now() - start) / 1000);\n  });\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"webglDiv\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      children: data.length\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n      className: \"webgl\",\n      ref: canvasMain\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 69,\n    columnNumber: 5\n  }, this);\n}\n\n_s(WebglAppSin, \"eerRSUIQXrqWLr9QmdFUEAin0qc=\");\n\n_c = WebglAppSin;\n\nvar _c;\n\n$RefreshReg$(_c, \"WebglAppSin\");","map":{"version":3,"names":["React","useEffect","useRef","getOverlayDirection","WebglPlot","WebglLine","ColorRGBA","webglp","line","line2","line3","WebglAppSin","data","canvasMain","TEST","Array","length","fill","map","Math","random","current","console","log","devicePixelRatio","window","width","clientWidth","height","clientHeight","numX","addLine","arrangeX","start","performance","now","flatData","slice","flat","max","i","numPoints","setY","round","update"],"sources":["/home/honza/webusb-test/src/webglAppSin.js"],"sourcesContent":["import React, { useEffect, useRef } from \"react\";\nimport { getOverlayDirection } from \"react-bootstrap/esm/helpers\";\n\nimport { WebglPlot, WebglLine, ColorRGBA } from \"webgl-plot\";\n\nimport './App.css';\n\n\nlet webglp;\nlet line;\nlet line2;\nlet line3;\n\n\nexport default function WebglAppSin({data}) {\n  const canvasMain = useRef(null);\n   let TEST = Array(data.length).fill().map(() => 256 * Math.random());\n\n\n\n  useEffect(() => {\n    if (canvasMain.current) {\n      console.log(\"webgl\");\n      const devicePixelRatio = window.devicePixelRatio || 1;\n      canvasMain.current.width =\n        canvasMain.current.clientWidth * devicePixelRatio;\n      canvasMain.current.height =\n        canvasMain.current.clientHeight * devicePixelRatio;\n\n      webglp = new WebglPlot(canvasMain.current);\n      const numX = 1000;\n\n      line = new WebglLine(new ColorRGBA(0, 1, 0, 1), numX);\n      webglp.addLine(line);\n      line.arrangeX();\n\n      line2 = new WebglLine(new ColorRGBA(1, 1, 0, 1), numX);\n      webglp.addLine(line2  );\n      line2.arrangeX();\n\n      line3 = new WebglLine(new ColorRGBA(0, 0, 1, 1), numX);\n      webglp.addLine(line3  );\n      line3.arrangeX();\n    }\n  }, []);\n\n  useEffect(() => {\n    console.log('rendering frame');\n    \n    let start = performance.now();\n    let flatData = data.length > 1 ? data.slice(data.length - 100, data.length).flat() : [1, 2, 3, 4];\n   // let flatData = Array(data.length).fill().map(() => 256 * Math.random());\n     \n    let max = 256;\n      for (let i = 0; i < line.numPoints; i++) {\n        line.setY(i, 1.3 * flatData[Math.round(flatData.length * i / line.numPoints)] / max  - 0.55);\n      }\n    \n    //  id = requestAnimationFrame(renderPlot);\n      webglp.update();\n      console.log((performance.now() - start) / 1000);\n\n    \n    });\n\n\n\n  return (\n    <div className=\"webglDiv\">\n      <div>{data.length}</div>\n      <canvas className=\"webgl\" ref={canvasMain} />\n    </div>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}