{"ast":null,"code":"import _inheritsLoose from \"@babel/runtime/helpers/esm/inheritsLoose\";\nimport { hashQueryKeyByOptions, matchQuery, parseFilterArgs } from './utils';\nimport { Query } from './query';\nimport { notifyManager } from './notifyManager';\nimport { Subscribable } from './subscribable'; // CLASS\n\nexport var QueryCache = /*#__PURE__*/function (_Subscribable) {\n  _inheritsLoose(QueryCache, _Subscribable);\n\n  function QueryCache(config) {\n    var _this;\n\n    _this = _Subscribable.call(this) || this;\n    _this.config = config || {};\n    _this.queries = [];\n    _this.queriesMap = {};\n    return _this;\n  }\n\n  var _proto = QueryCache.prototype;\n\n  _proto.build = function build(client, options, state) {\n    var _options$queryHash;\n\n    var queryKey = options.queryKey;\n    var queryHash = (_options$queryHash = options.queryHash) != null ? _options$queryHash : hashQueryKeyByOptions(queryKey, options);\n    var query = this.get(queryHash);\n\n    if (!query) {\n      query = new Query({\n        cache: this,\n        queryKey: queryKey,\n        queryHash: queryHash,\n        options: client.defaultQueryOptions(options),\n        state: state,\n        defaultOptions: client.getQueryDefaults(queryKey),\n        meta: options.meta\n      });\n      this.add(query);\n    }\n\n    return query;\n  };\n\n  _proto.add = function add(query) {\n    if (!this.queriesMap[query.queryHash]) {\n      this.queriesMap[query.queryHash] = query;\n      this.queries.push(query);\n      this.notify({\n        type: 'queryAdded',\n        query: query\n      });\n    }\n  };\n\n  _proto.remove = function remove(query) {\n    var queryInMap = this.queriesMap[query.queryHash];\n\n    if (queryInMap) {\n      query.destroy();\n      this.queries = this.queries.filter(function (x) {\n        return x !== query;\n      });\n\n      if (queryInMap === query) {\n        delete this.queriesMap[query.queryHash];\n      }\n\n      this.notify({\n        type: 'queryRemoved',\n        query: query\n      });\n    }\n  };\n\n  _proto.clear = function clear() {\n    var _this2 = this;\n\n    notifyManager.batch(function () {\n      _this2.queries.forEach(function (query) {\n        _this2.remove(query);\n      });\n    });\n  };\n\n  _proto.get = function get(queryHash) {\n    return this.queriesMap[queryHash];\n  };\n\n  _proto.getAll = function getAll() {\n    return this.queries;\n  };\n\n  _proto.find = function find(arg1, arg2) {\n    var _parseFilterArgs = parseFilterArgs(arg1, arg2),\n        filters = _parseFilterArgs[0];\n\n    if (typeof filters.exact === 'undefined') {\n      filters.exact = true;\n    }\n\n    return this.queries.find(function (query) {\n      return matchQuery(filters, query);\n    });\n  };\n\n  _proto.findAll = function findAll(arg1, arg2) {\n    var _parseFilterArgs2 = parseFilterArgs(arg1, arg2),\n        filters = _parseFilterArgs2[0];\n\n    return Object.keys(filters).length > 0 ? this.queries.filter(function (query) {\n      return matchQuery(filters, query);\n    }) : this.queries;\n  };\n\n  _proto.notify = function notify(event) {\n    var _this3 = this;\n\n    notifyManager.batch(function () {\n      _this3.listeners.forEach(function (listener) {\n        listener(event);\n      });\n    });\n  };\n\n  _proto.onFocus = function onFocus() {\n    var _this4 = this;\n\n    notifyManager.batch(function () {\n      _this4.queries.forEach(function (query) {\n        query.onFocus();\n      });\n    });\n  };\n\n  _proto.onOnline = function onOnline() {\n    var _this5 = this;\n\n    notifyManager.batch(function () {\n      _this5.queries.forEach(function (query) {\n        query.onOnline();\n      });\n    });\n  };\n\n  return QueryCache;\n}(Subscribable);","map":{"version":3,"names":["_inheritsLoose","hashQueryKeyByOptions","matchQuery","parseFilterArgs","Query","notifyManager","Subscribable","QueryCache","_Subscribable","config","_this","call","queries","queriesMap","_proto","prototype","build","client","options","state","_options$queryHash","queryKey","queryHash","query","get","cache","defaultQueryOptions","defaultOptions","getQueryDefaults","meta","add","push","notify","type","remove","queryInMap","destroy","filter","x","clear","_this2","batch","forEach","getAll","find","arg1","arg2","_parseFilterArgs","filters","exact","findAll","_parseFilterArgs2","Object","keys","length","event","_this3","listeners","listener","onFocus","_this4","onOnline","_this5"],"sources":["/home/honza/node_modules/react-query/es/core/queryCache.js"],"sourcesContent":["import _inheritsLoose from \"@babel/runtime/helpers/esm/inheritsLoose\";\nimport { hashQueryKeyByOptions, matchQuery, parseFilterArgs } from './utils';\nimport { Query } from './query';\nimport { notifyManager } from './notifyManager';\nimport { Subscribable } from './subscribable';\n// CLASS\nexport var QueryCache = /*#__PURE__*/function (_Subscribable) {\n  _inheritsLoose(QueryCache, _Subscribable);\n\n  function QueryCache(config) {\n    var _this;\n\n    _this = _Subscribable.call(this) || this;\n    _this.config = config || {};\n    _this.queries = [];\n    _this.queriesMap = {};\n    return _this;\n  }\n\n  var _proto = QueryCache.prototype;\n\n  _proto.build = function build(client, options, state) {\n    var _options$queryHash;\n\n    var queryKey = options.queryKey;\n    var queryHash = (_options$queryHash = options.queryHash) != null ? _options$queryHash : hashQueryKeyByOptions(queryKey, options);\n    var query = this.get(queryHash);\n\n    if (!query) {\n      query = new Query({\n        cache: this,\n        queryKey: queryKey,\n        queryHash: queryHash,\n        options: client.defaultQueryOptions(options),\n        state: state,\n        defaultOptions: client.getQueryDefaults(queryKey),\n        meta: options.meta\n      });\n      this.add(query);\n    }\n\n    return query;\n  };\n\n  _proto.add = function add(query) {\n    if (!this.queriesMap[query.queryHash]) {\n      this.queriesMap[query.queryHash] = query;\n      this.queries.push(query);\n      this.notify({\n        type: 'queryAdded',\n        query: query\n      });\n    }\n  };\n\n  _proto.remove = function remove(query) {\n    var queryInMap = this.queriesMap[query.queryHash];\n\n    if (queryInMap) {\n      query.destroy();\n      this.queries = this.queries.filter(function (x) {\n        return x !== query;\n      });\n\n      if (queryInMap === query) {\n        delete this.queriesMap[query.queryHash];\n      }\n\n      this.notify({\n        type: 'queryRemoved',\n        query: query\n      });\n    }\n  };\n\n  _proto.clear = function clear() {\n    var _this2 = this;\n\n    notifyManager.batch(function () {\n      _this2.queries.forEach(function (query) {\n        _this2.remove(query);\n      });\n    });\n  };\n\n  _proto.get = function get(queryHash) {\n    return this.queriesMap[queryHash];\n  };\n\n  _proto.getAll = function getAll() {\n    return this.queries;\n  };\n\n  _proto.find = function find(arg1, arg2) {\n    var _parseFilterArgs = parseFilterArgs(arg1, arg2),\n        filters = _parseFilterArgs[0];\n\n    if (typeof filters.exact === 'undefined') {\n      filters.exact = true;\n    }\n\n    return this.queries.find(function (query) {\n      return matchQuery(filters, query);\n    });\n  };\n\n  _proto.findAll = function findAll(arg1, arg2) {\n    var _parseFilterArgs2 = parseFilterArgs(arg1, arg2),\n        filters = _parseFilterArgs2[0];\n\n    return Object.keys(filters).length > 0 ? this.queries.filter(function (query) {\n      return matchQuery(filters, query);\n    }) : this.queries;\n  };\n\n  _proto.notify = function notify(event) {\n    var _this3 = this;\n\n    notifyManager.batch(function () {\n      _this3.listeners.forEach(function (listener) {\n        listener(event);\n      });\n    });\n  };\n\n  _proto.onFocus = function onFocus() {\n    var _this4 = this;\n\n    notifyManager.batch(function () {\n      _this4.queries.forEach(function (query) {\n        query.onFocus();\n      });\n    });\n  };\n\n  _proto.onOnline = function onOnline() {\n    var _this5 = this;\n\n    notifyManager.batch(function () {\n      _this5.queries.forEach(function (query) {\n        query.onOnline();\n      });\n    });\n  };\n\n  return QueryCache;\n}(Subscribable);"],"mappings":"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"},"metadata":{},"sourceType":"module"}