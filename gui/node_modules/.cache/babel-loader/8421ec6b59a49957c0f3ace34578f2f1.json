{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _inheritsLoose from \"@babel/runtime/helpers/esm/inheritsLoose\";\nimport { getDefaultState } from './mutation';\nimport { notifyManager } from './notifyManager';\nimport { Subscribable } from './subscribable'; // CLASS\n\nexport var MutationObserver = /*#__PURE__*/function (_Subscribable) {\n  _inheritsLoose(MutationObserver, _Subscribable);\n\n  function MutationObserver(client, options) {\n    var _this;\n\n    _this = _Subscribable.call(this) || this;\n    _this.client = client;\n\n    _this.setOptions(options);\n\n    _this.bindMethods();\n\n    _this.updateResult();\n\n    return _this;\n  }\n\n  var _proto = MutationObserver.prototype;\n\n  _proto.bindMethods = function bindMethods() {\n    this.mutate = this.mutate.bind(this);\n    this.reset = this.reset.bind(this);\n  };\n\n  _proto.setOptions = function setOptions(options) {\n    this.options = this.client.defaultMutationOptions(options);\n  };\n\n  _proto.onUnsubscribe = function onUnsubscribe() {\n    if (!this.listeners.length) {\n      var _this$currentMutation;\n\n      (_this$currentMutation = this.currentMutation) == null ? void 0 : _this$currentMutation.removeObserver(this);\n    }\n  };\n\n  _proto.onMutationUpdate = function onMutationUpdate(action) {\n    this.updateResult(); // Determine which callbacks to trigger\n\n    var notifyOptions = {\n      listeners: true\n    };\n\n    if (action.type === 'success') {\n      notifyOptions.onSuccess = true;\n    } else if (action.type === 'error') {\n      notifyOptions.onError = true;\n    }\n\n    this.notify(notifyOptions);\n  };\n\n  _proto.getCurrentResult = function getCurrentResult() {\n    return this.currentResult;\n  };\n\n  _proto.reset = function reset() {\n    this.currentMutation = undefined;\n    this.updateResult();\n    this.notify({\n      listeners: true\n    });\n  };\n\n  _proto.mutate = function mutate(variables, options) {\n    this.mutateOptions = options;\n\n    if (this.currentMutation) {\n      this.currentMutation.removeObserver(this);\n    }\n\n    this.currentMutation = this.client.getMutationCache().build(this.client, _extends({}, this.options, {\n      variables: typeof variables !== 'undefined' ? variables : this.options.variables\n    }));\n    this.currentMutation.addObserver(this);\n    return this.currentMutation.execute();\n  };\n\n  _proto.updateResult = function updateResult() {\n    var state = this.currentMutation ? this.currentMutation.state : getDefaultState();\n\n    var result = _extends({}, state, {\n      isLoading: state.status === 'loading',\n      isSuccess: state.status === 'success',\n      isError: state.status === 'error',\n      isIdle: state.status === 'idle',\n      mutate: this.mutate,\n      reset: this.reset\n    });\n\n    this.currentResult = result;\n  };\n\n  _proto.notify = function notify(options) {\n    var _this2 = this;\n\n    notifyManager.batch(function () {\n      // First trigger the mutate callbacks\n      if (_this2.mutateOptions) {\n        if (options.onSuccess) {\n          _this2.mutateOptions.onSuccess == null ? void 0 : _this2.mutateOptions.onSuccess(_this2.currentResult.data, _this2.currentResult.variables, _this2.currentResult.context);\n          _this2.mutateOptions.onSettled == null ? void 0 : _this2.mutateOptions.onSettled(_this2.currentResult.data, null, _this2.currentResult.variables, _this2.currentResult.context);\n        } else if (options.onError) {\n          _this2.mutateOptions.onError == null ? void 0 : _this2.mutateOptions.onError(_this2.currentResult.error, _this2.currentResult.variables, _this2.currentResult.context);\n          _this2.mutateOptions.onSettled == null ? void 0 : _this2.mutateOptions.onSettled(undefined, _this2.currentResult.error, _this2.currentResult.variables, _this2.currentResult.context);\n        }\n      } // Then trigger the listeners\n\n\n      if (options.listeners) {\n        _this2.listeners.forEach(function (listener) {\n          listener(_this2.currentResult);\n        });\n      }\n    });\n  };\n\n  return MutationObserver;\n}(Subscribable);","map":{"version":3,"names":["_extends","_inheritsLoose","getDefaultState","notifyManager","Subscribable","MutationObserver","_Subscribable","client","options","_this","call","setOptions","bindMethods","updateResult","_proto","prototype","mutate","bind","reset","defaultMutationOptions","onUnsubscribe","listeners","length","_this$currentMutation","currentMutation","removeObserver","onMutationUpdate","action","notifyOptions","type","onSuccess","onError","notify","getCurrentResult","currentResult","undefined","variables","mutateOptions","getMutationCache","build","addObserver","execute","state","result","isLoading","status","isSuccess","isError","isIdle","_this2","batch","data","context","onSettled","error","forEach","listener"],"sources":["/home/honza/node_modules/react-query/es/core/mutationObserver.js"],"sourcesContent":["import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _inheritsLoose from \"@babel/runtime/helpers/esm/inheritsLoose\";\nimport { getDefaultState } from './mutation';\nimport { notifyManager } from './notifyManager';\nimport { Subscribable } from './subscribable';\n// CLASS\nexport var MutationObserver = /*#__PURE__*/function (_Subscribable) {\n  _inheritsLoose(MutationObserver, _Subscribable);\n\n  function MutationObserver(client, options) {\n    var _this;\n\n    _this = _Subscribable.call(this) || this;\n    _this.client = client;\n\n    _this.setOptions(options);\n\n    _this.bindMethods();\n\n    _this.updateResult();\n\n    return _this;\n  }\n\n  var _proto = MutationObserver.prototype;\n\n  _proto.bindMethods = function bindMethods() {\n    this.mutate = this.mutate.bind(this);\n    this.reset = this.reset.bind(this);\n  };\n\n  _proto.setOptions = function setOptions(options) {\n    this.options = this.client.defaultMutationOptions(options);\n  };\n\n  _proto.onUnsubscribe = function onUnsubscribe() {\n    if (!this.listeners.length) {\n      var _this$currentMutation;\n\n      (_this$currentMutation = this.currentMutation) == null ? void 0 : _this$currentMutation.removeObserver(this);\n    }\n  };\n\n  _proto.onMutationUpdate = function onMutationUpdate(action) {\n    this.updateResult(); // Determine which callbacks to trigger\n\n    var notifyOptions = {\n      listeners: true\n    };\n\n    if (action.type === 'success') {\n      notifyOptions.onSuccess = true;\n    } else if (action.type === 'error') {\n      notifyOptions.onError = true;\n    }\n\n    this.notify(notifyOptions);\n  };\n\n  _proto.getCurrentResult = function getCurrentResult() {\n    return this.currentResult;\n  };\n\n  _proto.reset = function reset() {\n    this.currentMutation = undefined;\n    this.updateResult();\n    this.notify({\n      listeners: true\n    });\n  };\n\n  _proto.mutate = function mutate(variables, options) {\n    this.mutateOptions = options;\n\n    if (this.currentMutation) {\n      this.currentMutation.removeObserver(this);\n    }\n\n    this.currentMutation = this.client.getMutationCache().build(this.client, _extends({}, this.options, {\n      variables: typeof variables !== 'undefined' ? variables : this.options.variables\n    }));\n    this.currentMutation.addObserver(this);\n    return this.currentMutation.execute();\n  };\n\n  _proto.updateResult = function updateResult() {\n    var state = this.currentMutation ? this.currentMutation.state : getDefaultState();\n\n    var result = _extends({}, state, {\n      isLoading: state.status === 'loading',\n      isSuccess: state.status === 'success',\n      isError: state.status === 'error',\n      isIdle: state.status === 'idle',\n      mutate: this.mutate,\n      reset: this.reset\n    });\n\n    this.currentResult = result;\n  };\n\n  _proto.notify = function notify(options) {\n    var _this2 = this;\n\n    notifyManager.batch(function () {\n      // First trigger the mutate callbacks\n      if (_this2.mutateOptions) {\n        if (options.onSuccess) {\n          _this2.mutateOptions.onSuccess == null ? void 0 : _this2.mutateOptions.onSuccess(_this2.currentResult.data, _this2.currentResult.variables, _this2.currentResult.context);\n          _this2.mutateOptions.onSettled == null ? void 0 : _this2.mutateOptions.onSettled(_this2.currentResult.data, null, _this2.currentResult.variables, _this2.currentResult.context);\n        } else if (options.onError) {\n          _this2.mutateOptions.onError == null ? void 0 : _this2.mutateOptions.onError(_this2.currentResult.error, _this2.currentResult.variables, _this2.currentResult.context);\n          _this2.mutateOptions.onSettled == null ? void 0 : _this2.mutateOptions.onSettled(undefined, _this2.currentResult.error, _this2.currentResult.variables, _this2.currentResult.context);\n        }\n      } // Then trigger the listeners\n\n\n      if (options.listeners) {\n        _this2.listeners.forEach(function (listener) {\n          listener(_this2.currentResult);\n        });\n      }\n    });\n  };\n\n  return MutationObserver;\n}(Subscribable);"],"mappings":"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"},"metadata":{},"sourceType":"module"}